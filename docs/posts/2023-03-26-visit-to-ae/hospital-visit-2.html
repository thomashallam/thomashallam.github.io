<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tom Hallam">
<meta name="dcterms.date" content="2023-03-30">

<title>User Research, User-Centred Design, User Experience - Urgent digital healthcare: are we out of touch?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EMB22EEKPF"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-EMB22EEKPF', { 'anonymize_ip': false});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">User Research, User-Centred Design, User Experience</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Tom’s blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Hello</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources/links.html"> 
<span class="menu-text">Useful links</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/thomashallam"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/thomashallam"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/thomashallam"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Urgent digital healthcare: are we out of touch?</h1>
  <div class="quarto-categories">
    <div class="quarto-category">User Research</div>
    <div class="quarto-category">Healthcare</div>
    <div class="quarto-category">Digital</div>
    <div class="quarto-category">Hospital</div>
    <div class="quarto-category">Bookings</div>
    <div class="quarto-category">User Needs</div>
    <div class="quarto-category">Personal</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tom Hallam </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 30, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>People are what make healthcare work. There is a human role in every good bit of the experience </strong></p>
<p><a href="../../posts/2023-03-26-visit-to-ae/hospital-visit.html">Continues from part 1</a></p>
<p>Along my journey, from what I noticed, the most (useful) digital processes included:</p>
<ul>
<li>Maps and GPS navigation to hospital,</li>
<li>patient record lookup &amp; check-in at A&amp;E reception,</li>
<li>hospital patient triage / bed tracking system,</li>
<li>integrated local care record shows visit to UTC,</li>
<li>electronic X-ray results.</li>
</ul>
<p>That was it. None of the hospital staff-facing information was visible to me as a citizen.</p>
<p>As I sat in the hospital waiting area with an head injury (for over 5 hours), I had no clue what was happening with my care. Was there a plan?</p>
<p>At times high and specific expectations were set by staff: “you need a CT and to see a doctor”.</p>
<p>At other times updates were pretty vague “You are near the top of the pile”.</p>
<p>The pain was held back by Codeine, paracetemol, and the fact I didn’t need a stretcher. Several patients either arrived on a trolley or collapsed and had to be rushed through on one.</p>
<p>The waiting room is full (as expected). Diverse attendence, all ethnicities. Families, crying kids, drug users, drunk and disorderly, the homeless, foreign speakers, couples, individuals, sad people, happy people, vomitting people, screaming people.</p>
<blockquote class="blockquote">
<p>“I didn’t actually mind waiting, but not knowing what was going on did bother me most.””</p>
</blockquote>
<p>Some other patients clearly had less patience, e.g.&nbsp;asking what was going on every 30 minutes. Bothering staff more seemed to help people to get seen sooner.</p>
<p>I didn’t want to do this, but after 5 hours of watching who went in next you start to question the British Queuing etiquette.</p>
<p>Lots of people got up and left despite having waited many hours and were not being seen or treated.</p>
<p>In the end, I had to request more pain killers as the first batch wore off. After that request, I was seen within 1 hour.</p>
<p>After my named was called things were pretty fast: seen by a doctor, checked over, x-rayed, checked again, sent home.</p>
<p>A few days later, I feel pretty ok now apart from the significant bruising and swelling.</p>
<p>A lucky escape!</p>
<details class="spoiler" style="--hidden: url(/posts/2023-03-26-visit-to-ae/phot.jpg)">
<summary>
Warning: graphic content
</summary>
<div>
<img src="phot.jpg" alt="Finally checked the damage after x-ray">
</div>
</details>
<p><br></p>
<div style="page-break-after: always;"></div>
<section id="national-digital-healthcare---why-so-many-missed-opportunities" class="level2">
<h2 class="anchored" data-anchor-id="national-digital-healthcare---why-so-many-missed-opportunities"><strong>National digital healthcare - why so many missed opportunities</strong></h2>
<p>These are some challenges that I came up against. Friday night <em>may</em> have been a better with <em>a bit</em> more digital?</p>
<p>But then again, maybe none of this is even necessary? Maybe just ideas from LaLaLand.</p>
<p><strong>I got treated and got safely home and I am really very grateful for that.</strong></p>
<p>Obviously, these ideas for improving urgent healthcare wouldn’t have replaced the essential human interactions described above.</p>
<ul>
<li><strong>999</strong>
<ul>
<li>I work in the NHS and know they are always super busy! there was no way I was ringing 999 or an ambulance for myself after this accident!</li>
<li>As a typical parent, I pretend to be fine in for the kids and other parents (despite a huge golf ball bump and blood streaming everywhere)</li>
<li>I was in denial and had concussion. I didn’t perceive that I was injured badly</li>
<li>After 5 or 6 adults told me I needed to go to hospital (including 3 first aiders), I agreed it was the best option and so we set off</li>
</ul></li>
<li><strong>Accurate closing times</strong> for the Urgent Treatment Walk-in Centres (UTC)
<ul>
<li>advertised on Google as 11pm, but doors closed to patients at 9pm</li>
</ul></li>
<li><strong>Correct available facilities</strong> at UTC
<ul>
<li>Their website says they deal with severe head injuries, but the reality is they didn’t have staff, X-ray or CT scan available</li>
</ul></li>
<li><strong>Hospital-hospital transfers</strong> - UTC staff say they do not refer to hospital A&amp;E.
<ul>
<li>I was unsure if any notes were made or if a referral was created after I left. I assume local NHS providers use the same system, but I maybe wrong.</li>
</ul></li>
<li><strong>Check A&amp;E waiting times</strong> before you arrive
<ul>
<li>is it worth driving extra 20 minutes to another A&amp;E</li>
<li>e.g.&nbsp;York/Harrogate might be quiet - can you beat a 6 hour wait in Leeds?</li>
</ul></li>
<li><strong>Live wait times for treatments and severity</strong>
<ul>
<li>e.g.&nbsp;x-ray, CT or electronic display</li>
<li>make it clear how many are waiting in each category: critical, servere, routine</li>
<li>shows how many cases they have by severity</li>
<li>tell you which category you are in</li>
<li>unclear if it is 2 hours or 10 hours</li>
<li>at 1am some patients said they have been waiting since 5pm (8 hours?!)</li>
</ul></li>
<li><strong>Booking appointments/Scans</strong>
<ul>
<li>It appears no appointments can be booked between A&amp;E and UTC?</li>
<li>When they knew I was travelling over to LGI/A&amp;E. They could have booked the x-ray and sent me to that waiting area on arrival. Rather than the long wait and being triaged three times</li>
</ul></li>
<li><strong>Check-in on app when in arrivals/waiting area</strong>
<ul>
<li>Easy as Toolstation and Screwfix</li>
<li>Unclear what the added value of the frontline desk (unless you are lost, or don’t have a phone)</li>
</ul></li>
<li><strong>111/NHS App</strong>
<ul>
<li>I had completely forgot about this service. I tried the 111 triage 2 hours after being sat in A&amp;E.</li>
<li>It says to call 999 for ambulance (ironically).</li>
<li>I’m not sure how this channel would have much helped here, we had already decided to go to the hospital.</li>
<li>perhaps guidance for what to bring on a 6/7 hour A&amp;E hospital trip (e.g phone charger, water bottle, warm coat, food, money)</li>
</ul></li>
<li><strong>Tracking patients</strong> around the hospital waiting areas:
<ul>
<li>reduces time wasted for staff walking around asking other staff and patients where people are</li>
<li>reduce shouting out names and mispronouncing foreign names</li>
<li>identify who the sleeping people are without waking them up</li>
<li>reduce the fear around going to the toilet and missing your name call!</li>
<li>Try allocating seat numbers? or using NFC seat tags?</li>
<li>or Using GPS tracking of your phone / NHS App?</li>
<li>or track patient location on CCTV with machine learning?</li>
</ul></li>
<li><strong>Food and drinks</strong> to your seat
<ul>
<li>Injured people leaving because they are hungry</li>
<li>All coffee shops were shut, food/drinks trolley arrived once during 6 hours</li>
<li>Can you order Uber Eats or Deliveroo to the waiting room? LOL now you are just being lazy Tom, but I guess many people try this.</li>
</ul></li>
<li><strong>Free USB charging</strong> within the hospital
<ul>
<li>situation is you need to know to bring your own plug socket and cable, or bring a charging pack, or pay to borrow a USB charger</li>
</ul></li>
<li><strong>Better information about medicines</strong>.
<ul>
<li>After receiving some medicine, no info was provided about dosage or side effects to look out for.</li>
<li>How long do they last before I need more?</li>
<li>There is no record of receiving acute meds on my patient record</li>
</ul></li>
<li><strong>Meds check up</strong>
<ul>
<li>a way to request more medicines, as I had to disrupt the nurse who was checking another patient</li>
</ul></li>
<li><strong>Pain tracking</strong>
<ul>
<li>is it getting better/worse? has the bleeding stopped?</li>
<li>perhaps use 8k cameras and machine learning to observe and monitor patient situation directly</li>
</ul></li>
<li><strong>Triage outcome summary</strong>
<ul>
<li>initially told I need a CT scan, by time I see nurse and then doctor downgraded to x-ray check</li>
<li>if I had a memory loss problem after severe head injury this could have been quite difficult to recall</li>
</ul></li>
<li><strong>Dealing with overcrowding / flow issues</strong>
<ul>
<li>e.g.&nbsp;someone needs a quick tetanus jab after a dog bite, why waited nearly 6 hours?</li>
<li>booking them into priority UTC/GP appointment in the morning could free up 2 seats in the busy waiting area</li>
</ul></li>
<li><strong>A&amp;E visit in your patient record</strong>
<ul>
<li>Nothing appears on the NHS App medical record; apparently I didn’t visit?</li>
</ul></li>
<li><strong>Waiting on your own could be quite lonely</strong>
<ul>
<li>I’m sure something here about how could a chat system, or patient profile matching, or patient-generated entertainment highlights channel would be much better than the single small TV hidden in the corner playing a raunchy romcom.</li>
</ul></li>
<li><strong>Language translation</strong>
<ul>
<li>A parent speaking an international language collapsed, their kids didn’t speak much English</li>
<li>It was unclear if a translator was available. Could digital translation help more?</li>
</ul></li>
<li><strong>Free Wi-Fi</strong>
<ul>
<li>I’m pretty sure it was available.</li>
<li>Though I’m a sceptic and didn’t connect because you can’t tell know which one is real and secure</li>
<li>No signage saying which hospital network to use</li>
<li>Do cyber security teams identify and remove the rogue networks?</li>
</ul></li>
<li><strong>Test results</strong>
<ul>
<li>scans images are saved in the patient record</li>
<li>staff can see them, why not citizens?</li>
</ul></li>
<li><strong>Discharge notes</strong>
<ul>
<li>with a head injury I was required to take my own notes</li>
<li>information about medications / recovery / aftercare should be send to your phone</li>
<li>unclear whether it gets sent to the GP as well?</li>
</ul></li>
<li><strong>Follow-up Referrals</strong>
<ul>
<li>could an automated follow-up with GP / physio be created. Really useful if your condition gets worse.</li>
<li>e.g.&nbsp;after I got woke eye socket feels disjointed. I noticed my shoulder was really badly bumped to and it is unclear that was x-rayd?</li>
<li>obviously most of the attention was on my face/head injury. have they already checked for a dislocated shoulder or fractured ribs? who knows. Again seeing what had been x-rayd might answer that.</li>
</ul></li>
</ul>
<hr>
</section>
<section id="while-none-of-these-ideas-may-feasible-or-good-some-just-might-be" class="level2">
<h2 class="anchored" data-anchor-id="while-none-of-these-ideas-may-feasible-or-good-some-just-might-be">While none of these ideas may feasible (or good), some just might be!</h2>
<p>We need to learn more about A&amp;E departments current priorities (my subjective perspective):</p>
<p>What are their “Must Haves”?</p>
<ol type="1">
<li>Save lives (i.e.&nbsp;critically unwell)</li>
<li>Treat severe and life-changing injuries: improving survival chance and outcomes</li>
<li>Work within financial and legal constraints (no unlimited budgets!)</li>
</ol>
<p>And should haves?</p>
<ol start="4" type="1">
<li>Staff well-being, physical and mental health</li>
<li>Treating none life-changing/minor injuries/ailments</li>
</ol>
<p>And could haves?</p>
<ol start="6" type="1">
<li>Provide support for patient health and well-being, holistic preventative care</li>
<li>Improve inclusion and equity by meeting accessibility legal requirements</li>
<li>Improve the experience, such as joining up or streamlining care journeys</li>
</ol>
</section>
<section id="priorities-are-a-big-deal" class="level2">
<h2 class="anchored" data-anchor-id="priorities-are-a-big-deal"><strong>Priorities are a big deal</strong></h2>
<p>We often encourage product teams to “improve the experience”, but unless this contributes towards achieving some higher priority stakeholders often stop it from happenning!</p>
<p>I’m sure some exemplar hospitals have tried similar ideas before.</p>
<p>It is very difficult to test new ideas in hospital. You cannot just implement ideas an technology without first passing huge amounts of regulatory approval and industrial standards, e.g.&nbsp;medical devices, software and AI.</p>
<p>Having so many ideas and hoops to jump through means big transformational change can take decades.</p>
<p><br></p>
<div style="page-break-after: always;"></div>
</section>
<section id="a-real-wake-up-call" class="level2">
<h2 class="anchored" data-anchor-id="a-real-wake-up-call">A real wake up call</h2>
<p>Honestly, I don’t know what to expect from healthcare system these days.</p>
<p>At times the care is excellent, at other times it seems you are being ghosted.</p>
<p>What I think and know could be possible, feels like a very <em>very very</em> long way off the reality of my lived experience.</p>
<p>I hope, with the passion of my heart, that we can do more with technology to make things safer and improve the experience for patients.</p>
<p>My rational mind feels like possibility for progress slip further away each year. Despite my advancing expectations set by sci-fi visions of health in movies and the media each year.</p>
<blockquote class="blockquote">
<p>“How do we keep our teams motivated to focussing on moving things forward when there are many blockers, legacy constraints, and a lot of uncertainty across the system?”</p>
</blockquote>
<ul>
<li>how can we align our teams around highest-priority areas of clinical risk?</li>
<li>how do we create bigger impact from our research projects?</li>
<li>how do we better represent the communities we serve?</li>
<li>how can we connect with colleagues from across the whole healthcare system?</li>
<li>how can we find nad share evidence of unmet user needs, aligning this with policy?</li>
<li>how can we better track our progress and the impact of decision making?</li>
</ul>
<p>In summary, who the heck knows what the future holds for the NHS!</p>
<p>Our user researchers are immersed in the frontline system and policy problems evey day. It is difficult work. It can be quite intense, traumatising and frustrating. With many areas of work being pushed to their limits, we need to focus on mental health and colleague well-being now more than ever.</p>
<p>Take care everyone. And if you ride a scooter, please do wear a helmet!</p>
<p>Tom</p>
<p><br></p>
</section>
<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr"><strong>TL;DR</strong></h2>
<p>This post is about my journey to an Urgent Treatment Centre and then 6 hours at A&amp;E. After a dramatic and stupid fall off my sons scooter, and a serious head injury.</p>
<p>What is the benefit and impact of digital in urgent care journeys? Systems are capturing data but often patients are left in the lurch.</p>
<p>Are there more opportunities for digital to help transform urgent care? Or are capacity constraints the barrier to progress and outcomes?</p>
<p>It is a complex landscape and being dropped into a serious health situation was a great wake up call.</p>
<hr>
</section>
<section id="let-me-know-what-you-thought-below-or-on-twitter" class="level2">
<h2 class="anchored" data-anchor-id="let-me-know-what-you-thought-below-or-on-twitter">Let me know what you thought below or <a href="https://twitter.com/thomashallam" class="external" target="_blank">on Twitter</a></h2>
<script src="https://giscus.app/client.js" data-repo="thomashallam/thomashallam.github.io" data-repo-id="R_kgDOIW_M2g" data-category="General" data-category-id="DIC_kwDOIW_M2s4CSpZr" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="dark_protanopia" data-lang="en" data-loading="lazy" crossorigin="anonymous" async="">
</script>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>